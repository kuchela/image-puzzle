
<!DOCTYPE html>
<html>
<head>
<title>Image Puzzle</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { font-family: Arial; text-align: center; margin: 0; padding: 0; }
  h1 { font-size: 1.5em; margin: 10px; }
  #timer { font-size: 1.2em; margin: 10px; }
  #controls { margin: 10px; }
  #puzzle { display: grid; grid-template-columns: repeat(3, 1fr); gap: 2px; max-width: 95vw; margin: auto; }
  .cell { width: 100%; position: relative; border: 1px solid #ccc; min-height: 80px; }
  .piece { width: 100%; height: auto; cursor: pointer; }
  .selected { outline: 4px solid red; }
  button { padding: 10px 15px; font-size: 16px; cursor: pointer; }
</style>
</head>
<body>
<h1>Image Puzzle</h1>
<div id="timer">Time left: <span id="time">120</span>s</div>
<div id="controls"><button onclick="shufflePieces()">Shuffle Again</button></div>
<div id="puzzle"></div>

<script>
const pieces = [
  "piece_0_0.png","piece_0_1.png","piece_0_2.png",
  "piece_1_0.png","piece_1_1.png","piece_1_2.png",
  "piece_2_0.png","piece_2_1.png","piece_2_2.png"
];

let selectedPiece = null;
let timeLeft = 120;
let timer = setInterval(updateTimer, 1000);

function updateTimer() {
  timeLeft--;
  document.getElementById('time').innerText = timeLeft;
  if (timeLeft <= 0) {
    clearInterval(timer);
    alert("Time's up! Try again?");
    location.reload();
  }
}

function renderPuzzle(order) {
  const puzzle = document.getElementById('puzzle');
  puzzle.innerHTML = '';
  order.forEach(id => {
    const cell = document.createElement('div');
    cell.className = 'cell';
    const img = document.createElement('img');
    img.src = id;
    img.id = id;
    img.className = 'piece';
    img.onclick = () => selectPiece(img);
    cell.appendChild(img);
    puzzle.appendChild(cell);
  });
}

function selectPiece(piece) {
  if (!selectedPiece) {
    selectedPiece = piece;
    piece.classList.add('selected');
  } else {
    const tempParent = piece.parentNode;
    const selectedParent = selectedPiece.parentNode;
    selectedParent.appendChild(piece);
    tempParent.appendChild(selectedPiece);
    selectedPiece.classList.remove('selected');
    selectedPiece = null;
    checkSolved();
  }
}

function shufflePieces() {
  const shuffled = [...pieces].sort(() => Math.random() - 0.5);
  renderPuzzle(shuffled);
}

function checkSolved() {
  const currentOrder = Array.from(document.querySelectorAll('#puzzle img')).map(p => p.id);
  if (JSON.stringify(currentOrder) === JSON.stringify(pieces)) {
    clearInterval(timer); // Stop timer
    document.getElementById('timer').style.display = 'none'; // Hide timer
    alert('Puzzle Solved!');
  }
}

shufflePieces();
</script>
</body>
</html>
